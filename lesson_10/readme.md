# Проект автотестов для X-Clients

## Описание

Этот проект содержит автотесты для API X-Clients, которые тестируют создание, обновление, получение и удаление сотрудников и компаний через API. Тесты включают работу с базой данных, где автоматически создаются и удаляются тестовые данные.


- `pytest` — основная библиотека для написания тестов
- `requests` — для отправки HTTP-запросов
- `SQLAlchemy` — для работы с базой данных
- `psycopg2-binary` — драйвер PostgreSQL для Python
- `allure-pytest` — для генерации отчётов с использованием Allure

## Структура проекта

test_auth.py 

test_create_company.py 

test_post_employee.py 

test_get_employees.py

test_get_employee_by_id.py

test_patch_employee.py 

## Установка и настройка проекта

## Настройка базы данных:

Убедитесь, что у вас настроена база данных PostgreSQL, и что строка подключения указана правильно в файле db_utils.py:

DATABASE_URL = "postgresql://x_clients_user:password@hostname/x_clients_db"


## Запуск тестов следует выполнять в определенной последовательности, чтобы избежать ошибок и зависимостей между тестами. Рекомендуемая последовательность:

test_auth.py — Этот тест выполняется первым, так как он отвечает за получение токена, который используется в других тестах для авторизации.

test_create_company.py — Создание компании также должно быть сделано до выполнения других тестов, так как это необходимо для тестов, связанных с сотрудниками.

test_post_employee.py — Создание сотрудника через API. Этот тест зависит от наличия компании, созданной на предыдущем шаге.

test_get_employees.py — Получение списка сотрудников, добавленных в базу данных. Этот тест зависит от предыдущего теста test_post_employee.py.

test_get_employee_by_id.py — Получение сотрудника по ID. Этот тест зависит от теста test_post_employee.py, который создает сотрудника.

test_patch_employee.py — Обновление данных сотрудника. Этот тест также зависит от создания сотрудника в test_post_employee.py.


## Запуск тестов

## Запуск тестов без Allure:

Для того чтобы просто запустить тесты без генерации отчёта, выполните команду:

pytest

## Запуск тестов с генерацией отчёта Allure:

Для генерации отчёта с помощью Allure выполните команду:

pytest --alluredir=allure-results

Это создаст папку allure-results, где будут храниться результаты тестов.

## Просмотр отчёта Allure

После установки Allure можно открыть отчёт локально, выполнив команду:

allure serve allure-results
